<div ng-controller="ClientController as vm">
    <div>
        <input type="text" ng-model="vm.connection.addr" placeholder="127.0.0.1:6565" ng-disabled="vm.client"></input>
        <button type="button" class="btn btn-default" ng-click="vm.connectClient(vm.connection.addr)" ng-disabled="vm.client">Connect</button>
    </div>

    <div>
        <span ng-repeat="method in vm.client.methods">
            <button type="button" class="btn btn-warning" ng-click="vm.setMethod(method)">{{method.name}}</button>
        </span>

        <div ng-show="vm.selectedMethod" class="well">
            <div>
                <h4>Metadata</h4>
                <div class="col-md-12">
                    <!--key, value, minus button-->
                    <div class="row" ng-repeat="metadata in vm.metadataArgs">
                        <div class="col-md-4">
                            <input type="text" ng-model="metadata.key">
                            </input>
                        </div>

                        <div class="col-md-4">
                            <input type="text" ng-model="metadata.value">
                            </input>
                        </div>

                        <div class="col-md-1">
                            <button ng-click="vm.removeMetadata(metadata)">Remove</button>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <button ng-click="vm.addMetadata()">Add</button>
                </div>
            </div>

            <div class="row" ng-if="!vm.selectedMethod.isStream">
                <div>
                    <button type="button" class="btn btn-info" ng-click="vm.execute(vm.selectedMethod, vm.argStr)">Send</button>
                </div>
            </div>

            <div class="row" ng-if="vm.selectedMethod.isStream">
                <div ng-if="!vm.stream.isConnected">
                    <button type="button" class="btn btn-info" ng-click="vm.connectStream(vm.selectedMethod)">Connect</button>
                </div>
                <div ng-if="vm.stream.isConnected">
                    <button type="button" class="btn btn-info" ng-click="vm.sendStream(vm.stream, vm.argStr)">Send Message</button>
                </div>
                <div ng-if="vm.stream.isConnected">
                    <button type="button" class="btn btn-info" ng-click="vm.closeStream(vm.stream)">Close</button>
                </div>
            </div>

            <div class="row" ng-if="!vm.selectedMethod.isStream || vm.stream.isConnected">
                <div class="col-md-4">
                    <textarea placeholder="argument (JSON)" ng-model="vm.argStr">
                    </textarea>
                </div>

                <div>
                    <div ng-if="vm.result != null">
                        <pre ng-bind-html="vm.result | prettify"></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>